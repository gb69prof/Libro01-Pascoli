<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Libro.0 ‚Äì Pascoli</title>

  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="themes.css">
  <script src="themes.js" defer></script>
  <script defer src="script-common.js"></script>
  <script defer src="script-index.js"></script>

  <style>
    /* Sovrascrivo lo sfondo del modale per togliere l'effetto "cartoncino" */
    #modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.9);
      z-index: 9999;
    }

    #modal-overlay[hidden] {
      display: none;
    }

    #modal-overlay .modal {
      width: 100%;
      height: 100%;
      position: relative;
      background: transparent;
      box-shadow: none;
    }

    .modal-center-wrapper {
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .modal-center-wrapper img {
      max-width: 100%;
      max-height: 100%;
      width: auto;
      height: auto;
      border-radius: 0;
      box-shadow: 0 0 18px rgba(0,0,0,0.7);
      cursor: pointer;
}

    #modal-close {
      position: absolute;
      top: 16px;
      right: 16px;
      font-size: 1.8rem;
      line-height: 1;
      background: #ffffff;
      border-radius: 999px;
      padding: 0.1rem 0.6rem;
      border: none;
      cursor: pointer;
    }

    /* Riquadro video flottante e trascinabile */
    .floating-video {
      position: fixed;
      top: 10%;
      left: 60%;
      width: 420px;
      max-width: 90vw;
      background: var(--card-bg, #ffffff);
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.35);
      z-index: 9990;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .floating-video[hidden] {
      display: none;
    }

    .floating-video-header {
      padding: 0.5rem 0.75rem;
      background: rgba(0,0,0,0.8);
      color: #f5f5f5;
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: move; /* area di drag */
      user-select: none;
    }

    .floating-video-header span {
      font-size: 0.9rem;
      font-weight: 600;
    }

    .floating-video-close {
      border: none;
      background: transparent;
      color: inherit;
      font-size: 1.1rem;
      line-height: 1;
      cursor: pointer;
      padding: 0 0 0 0.5rem;
    }

    .floating-video-body {
      padding: 0.5rem;
    }

    .floating-video-body iframe {
      width: 100%;
      height: 230px;
      border: none;
      border-radius: 8px;
    }

    @media (max-width: 768px) {
      .floating-video {
        top: 5%;
        left: 5%;
        width: 90vw;
      }

      .floating-video-body iframe {
        height: 200px;
      }
    }

    /* Link "video intro" sotto l'immagine */
    .video-intro-link {
      margin-top: 0.35rem;
      padding: 0.25rem 0.75rem;
      font-size: 0.9rem;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,0.2);
      background: rgba(255,255,255,0.85);
      cursor: pointer;
      transition: background 0.2s, transform 0.1s, box-shadow 0.2s;
    }

    .theme-D .video-intro-link {
      background: rgba(20,20,20,0.9);
      color: #f5f5f5;
      border-color: rgba(255,255,255,0.25);
    }

    .video-intro-link:hover {
      transform: translateY(-1px);
      box-shadow: 0 2px 6px rgba(0,0,0,0.25);
    }

    .video-intro-link:active {
      transform: translateY(0);
      box-shadow: none;
    }
  </style>
</head>

<body data-page="index">

  <!-- NAVBAR LIBRO.0 -->
  <nav class="navbar-libro0">
    <div class="nav-logo">
      <a href="index.html">üìò Libro.0</a>
    </div>
    <ul class="nav-links">
      <li><a href="index.html">Home</a></li>
      <li><a href="lettura.html">Lettura</a></li>
      <li><a href="annota.html">Annota</a></li>
      <li><a href="mappe.html">Mappe</a></li>
      <li><a href="lavagna.html">Lavagna</a></li>
      <li><a href="timeline.html">Timeline</a></li>
      <li><a href="archivio.html">Archivio</a></li>
      <li><a href="crea.html">Crea</a></li>
      <li><a href="ricerca.html">Ricerca</a></li>
    </ul>
  </nav>

  <header class="top-bar">
    <div class="logo-area">
      <span class="logo-main">Libro.0</span>
      <span class="logo-sub">Lo spazio del pensare</span>
    </div>

    <div class="theme-switcher" aria-label="Selettore tema">
      <button data-theme="A">A</button>
      <button data-theme="B">B</button>
      <button data-theme="C">C</button>
      <button data-theme="D">D</button>
      <button data-theme="E">E</button>
    </div>

    <nav class="tools-nav" aria-label="Strumenti Libro.0">
      <button class="tool-btn" data-tool="mappe">üó∫Ô∏è Mappe</button>
      <button class="tool-btn" data-tool="lavagna">üìù Lavagna</button>
      <button class="tool-btn" data-tool="archivio">üìÅ Archivio</button>
    </nav>
  </header>

  <main class="intro-main">
    <section class="intro-hero">

      <!-- COLONNA SINISTRA -->
      <div class="intro-text">
        <h1>Giovanni Pascoli nel Libro.0</h1>

        <p>
          Questo ambiente non √® una semplice scheda di letteratura, ma una stanza del Libro.0:
          qui la lezione scritta convive con schemi, immagini, video e strumenti che trasformano
          lo studente in autore attivo del proprio studio.
        </p>

        <p>
          Puoi leggere i testi, evidenziare, prendere appunti, inviare concetti alle mappe,
          alla timeline o alla lavagna virtuale. Ogni gesto lascia traccia in una memoria lunga.
        </p>

        <h2>Capitoli di Pascoli</h2>
        <ol class="chapter-list intro-list">
          <li><a href="stupore.html">1 ¬∑ Lo stupore</a></li>
          <li><a href="visione.html">2 ¬∑ Visione del mondo</a></li>
          <li><a href="fanciullino.html">3 ¬∑ Poetica del fanciullino</a></li>
          <li><a href="forma.html">4 ¬∑ La forma</a></li>
          <li><a href="simbolismo.html">5 ¬∑ Il simbolismo</a></li>
        </ol>

        <!-- SEZIONE NUOVA -->
        <h2>I testi</h2>
        <ul class="chapter-list intro-list">
          <li>
            <a href="gelsomino/index.html" target="_blank">
              Il gelsomino notturno ‚Äì lezione interattiva
            </a>
          </li>
          <li>
            <a href="x-agosto.html" target="_blank">
              X agosto ‚Äì analisi e pagina interattiva
            </a>
          </li>
          <li>
            <a href="digitale-purpurea.html" target="_blank">
              Digitale purpurea ‚Äì testo e analisi
            </a>
          </li>
        </ul>
      </div>

      <!-- COLONNA DESTRA -->
      <div class="intro-media">

        <figure class="video-cover-wrapper" style="max-width:260px; margin:0 auto;">
          <div id="cover-wrapper">
            <img
              id="pascoli-cover"
              src="assets/pascoli_video.png"
              alt="Introduzione a Pascoli"
              style="width:100%; height:auto; cursor:pointer; display:block;"
            />
          </div>

          <div id="video-container" hidden>
            <div
              style="position:relative; width:100%; padding-top:56.25%; overflow:hidden; border-radius:12px;"
            >
              <iframe
                src="https://app.heygen.com/embedded-player/921a340e480a48fa94d440855d633b4a"
                title="HeyGen video player"
                frameborder="0"
                allow="encrypted-media; fullscreen;"
                allowfullscreen
                style="position:absolute; top:0; left:0; width:100%; height:100%;"
              ></iframe>
            </div>

            <button id="btn-back-to-cover" class="back-btn" style="margin-top:0.5rem;">
              ‚èπ Torna all'immagine
            </button>
          </div>

          <figcaption style="text-align:center; margin-top:0.5rem;">
            Clicca l'immagine per avviare il video introduttivo.
          </figcaption>
        </figure>

        <figure class="intro-image">
          <img
            id="pascoli-intro"
            src="assets/Pascoli-intro.png"
            alt="Giovanni Pascoli ‚Äì immagine introduttiva"
            style="max-width:260px; width:100%; height:auto; margin:1.5rem auto 0.5rem auto; cursor:pointer; display:block;"
          />
          <figcaption style="text-align:center; margin-top:0.5rem;">
            Giovanni Pascoli, tra biografia, visione del mondo e simboli.<br>
            <button
              id="video-intro-trigger"
              class="video-intro-link"
              type="button"
            >
              video intro
            </button>
          </figcaption>
        </figure>

      </div>
    </section>
  </main>

  <!-- RIQUADRO VIDEO FLOTANTE -->
  <div id="floating-video" class="floating-video" hidden>
    <div id="floating-video-header" class="floating-video-header">
      <span>Video intro ‚Äì Pascoli</span>
      <button id="floating-video-close" class="floating-video-close" type="button">‚úï</button>
    </div>
    <div class="floating-video-body">
      <iframe
        src="https://www.youtube.com/embed/OHzHzKf0vdE?si=XMj86J94P6CSupEL"
        title="YouTube video player"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        referrerpolicy="strict-origin-when-cross-origin"
        allowfullscreen
      ></iframe>
    </div>
  </div>

  <!-- MODALE IMMAGINE FULLSCREEN -->
  <div id="modal-overlay" class="modal-overlay" hidden>
    <div class="modal">
      <button id="modal-close">‚úï</button>
      <div id="modal-content"></div>
    </div>
  </div>

  <!-- SCRIPT IMMAGINE INGRANDITA + VIDEO FLOTANTE -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      /* --- Immagine Pascoli-intro a schermo intero (toggle) --- */
      const introImg = document.getElementById('pascoli-intro');
      const modalOverlay = document.getElementById('modal-overlay');
      const modalContent = document.getElementById('modal-content');
      const modalClose = document.getElementById('modal-close');

      if (introImg && modalOverlay && modalContent && modalClose) {
        introImg.addEventListener('click', () => {
          // Se il modale √® gi√† aperto, lo chiudo (secondo click)
          if (!modalOverlay.hidden) {
            modalOverlay.hidden = true;
            modalContent.innerHTML = '';
            return;
          }

          // Altrimenti lo apro con l'immagine a tutto schermo
          modalContent.innerHTML = '';
          const wrapper = document.createElement('div');
          wrapper.className = 'modal-center-wrapper';

          const bigImg = introImg.cloneNode();
          bigImg.removeAttribute('style');

          wrapper.appendChild(bigImg);
          modalContent.appendChild(wrapper);

          modalOverlay.hidden = false;

          const close = () => {
            modalOverlay.hidden = true;
            modalContent.innerHTML = '';
          };

          bigImg.addEventListener('click', close);
          modalClose.addEventListener('click', close, { once: true });
          modalOverlay.addEventListener('click', e => {
            if (e.target === modalOverlay) close();
          }, { once: true });
        });
      }

      /* --- Riquadro video intro flottante e trascinabile --- */
      const floatingVideo = document.getElementById('floating-video');
      const floatingHeader = document.getElementById('floating-video-header');
      const floatingClose = document.getElementById('floating-video-close');
      const videoIntroTrigger = document.getElementById('video-intro-trigger');

      if (videoIntroTrigger && floatingVideo) {
        videoIntroTrigger.addEventListener('click', () => {
          floatingVideo.hidden = false;
        });
      }

      if (floatingClose && floatingVideo) {
        floatingClose.addEventListener('click', () => {
          floatingVideo.hidden = true;
        });
      }

      // Funzione per rendere il riquadro trascinabile
      function makeDraggable(el, handle) {
        if (!el || !handle) return;

        let isDown = false;
        let offsetX = 0;
        let offsetY = 0;

        const onMouseDown = (e) => {
          isDown = true;
          const rect = el.getBoundingClientRect();
          offsetX = e.clientX - rect.left;
          offsetY = e.clientY - rect.top;
          document.addEventListener('mousemove', onMouseMove);
          document.addEventListener('mouseup', onMouseUp);
        };

        const onMouseMove = (e) => {
          if (!isDown) return;
          const x = e.clientX - offsetX;
          const y = e.clientY - offsetY;
          el.style.left = x + 'px';
          el.style.top = y + 'px';
        };

        const onMouseUp = () => {
          isDown = false;
          document.removeEventListener('mousemove', onMouseMove);
          document.removeEventListener('mouseup', onMouseUp);
        };

        handle.addEventListener('mousedown', onMouseDown);
      }

      makeDraggable(floatingVideo, floatingHeader);
    });
  </script>
</body>
</html>
