<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Libro.0 â€“ Stanza delle mappe concettuali</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="themes.css" />
  <script src="themes.js" defer></script>
  <script src="script-common.js" defer></script>
</head>
<body data-page="mappe">
  <!-- NAVBAR LIBRO.0 -->
  <nav class="navbar-libro0">
    <div class="nav-logo">
      <a href="index.html">ðŸ“˜ Libro.0</a>
    </div>
    <ul class="nav-links">
      <li><a href="index.html">Home</a></li>
      <li><a href="lettura.html">Lettura</a></li>
      <li><a href="annota.html">Annota</a></li>
      <li><a href="mappe.html">Mappe</a></li>
      <li><a href="lavagna.html">Lavagna</a></li>
      <li><a href="timeline.html">Timeline</a></li>
      <li><a href="archivio.html">Archivio</a></li>
      <li><a href="crea.html">Crea</a></li>
      <li><a href="ricerca.html">Ricerca</a></li>
    </ul>
  </nav>

  <header class="top-bar">
    <div class="logo-area">
      <span class="logo-main">Libro.0</span>
      <span class="logo-sub">Stanza delle mappe</span>
    </div>
    <div class="theme-switcher" aria-label="Selettore tema">
      <button data-theme="A">A</button>
      <button data-theme="B">B</button>
      <button data-theme="C">C</button>
      <button data-theme="D">D</button>
      <button data-theme="E">E</button>
    </div>
  </header>

  <main class="room-main">
    <section class="room-intro">
      <h1>Mappe concettuali</h1>
      <p>
        Qui il materiale della lettura viene trasformato in struttura: nodi, frecce, categorie.
        Nel prototipo trovi un semplice schema di nodi testuali trascinabili.
      </p>
    </section>

    <section class="room-grid">
      <div class="room-card full-width">
        <h2>Mappa rapida (demo locale)</h2>
        <p>
          Trascina i nodi per organizzare il pensiero nello spazio. I dati non vengono salvati,
          ma il gesto Ã¨ giÃ  quello della mappa concettuale.
        </p>

        <div id="mappe-canvas" class="mappe-canvas">
          <!-- Riga 1 -->
          <div class="map-node" style="top:20px; left:20px;">Pascoli</div>
          <div class="map-node" style="top:20px; left:220px;">Sentimento base</div>
          <div class="map-node" style="top:20px; left:440px;">Stupore</div>

          <!-- Riga 2 -->
          <div class="map-node" style="top:130px; left:20px;">Paura</div>
          <div class="map-node" style="top:130px; left:220px;">Visione del mondo</div>
          <div class="map-node" style="top:130px; left:440px;">Contro la scienza</div>

          <!-- Riga 3 -->
          <div class="map-node" style="top:240px; left:20px;">Socialismo-nazionalismo</div>
          <div class="map-node" style="top:240px; left:260px;">Fanciullino</div>
          <div class="map-node" style="top:240px; left:480px;">Poetica</div>

          <!-- Riga 4 -->
          <div class="map-node" style="top:350px; left:120px;">Fiore</div>
          <div class="map-node" style="top:350px; left:360px;">Simbolismo</div>
        </div>
      </div>
    </section>
  </main>

  <script>
    (function() {
      const nodes = document.querySelectorAll(".map-node");
      let active = null;
      let offsetX = 0, offsetY = 0;

      nodes.forEach(node => {
        node.addEventListener("mousedown", startDrag);
        node.addEventListener("touchstart", startDrag, { passive: false });
      });

      function startDrag(e) {
        e.preventDefault();
        active = e.currentTarget;
        const rect = active.getBoundingClientRect();
        const clientX = e.touches ? e.touches[0].clientX : e.clientX;
        const clientY = e.touches ? e.touches[0].clientY : e.clientY;
        offsetX = clientX - rect.left;
        offsetY = clientY - rect.top;
        document.addEventListener("mousemove", onMove);
        document.addEventListener("mouseup", endDrag);
        document.addEventListener("touchmove", onMove, { passive: false });
        document.addEventListener("touchend", endDrag);
      }

      function onMove(e) {
        if (!active) return;
        const canvas = document.getElementById("mappe-canvas");
        const bounds = canvas.getBoundingClientRect();
        const clientX = e.touches ? e.touches[0].clientX : e.clientX;
        const clientY = e.touches ? e.touches[0].clientY : e.clientY;
        let x = clientX - bounds.left - offsetX;
        let y = clientY - bounds.top - offsetY;
        active.style.left = x + "px";
        active.style.top = y + "px";
      }

      function endDrag() {
        active = null;
        document.removeEventListener("mousemove", onMove);
        document.removeEventListener("mouseup", endDrag);
        document.removeEventListener("touchmove", onMove);
        document.removeEventListener("touchend", endDrag);
      }
    })();
  </script>
</body>
</html>
